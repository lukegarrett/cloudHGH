tasks:
    - name: Update Aptitude
      shell: "sudo apt update"

    - name: Install Docker
      shell: "sudo apt install docker.io"

    - name: Docker mod
      replace:
        path: /lib/systemd/system/docker.service
        regexp: 'ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock'
        replace: 'ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd'
    
    - name: Start Docker Service
      shell: "sudo systemctl start docker"

    - name: Enable Docker Service
      shell: "sudo systemctl enable docker" 

    - name: Install Curl
      shell: "sudo apt install -y apt-transport-https ca-certificates curl"

    - name: Curl Kubernetes Key
      shell: "sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg"

    - name: Add Kubernetes Key
      shell: "echo \"deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-focal main\" | sudo tee -a /etc/apt/sources.list.d/kubernetes.list" 

    - name: Install Kubernetes
      shell: "sudo apt install kubeadm kubelet kubectl kubernetes-cni"  

    - name: Disable Swap
      shell: "sudo swapoff -a" 
